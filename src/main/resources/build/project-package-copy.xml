<?xml version="1.0"?>

<!-- ======================================================================= -->
<!-- Handpay back server build file                                                       -->
<!-- ======================================================================= -->

<project name="project copy" default="copy" basedir=".">

	<property environment="env" />
	<property name="deployPath" value="${env.JBOSS_HOME}/server/default/deploy/hpay" />
	
	<import file="project-list.xml" />

	<target name="init">
		<echo message="beginning compile ${project.name} project ...." />
	</target>

	<target name="clean" depends="init">
		<delete dir="${project.target}" />
		<mkdir dir="${project.target}" />
	</target>
	
	<target name="foreach" depends="clean" >
		<foreach target="cp" list="${project.list}" param="project.one" inheritall="true">
		</foreach>
	</target>

	<target name="cp">
		<propertycopy name="project.name" from="project.name.${project.one}" />
		<echo message="begin copy the project: ${project.name}" />

		<!-- copy the output file from the dist directory -->
		<if>
			<or>
				<equals arg1="${project.name}" arg2="hpayVersionControl" />
				<equals arg1="${project.name}" arg2="hpayMaven" />
				<equals arg1="${project.name}" arg2="hpayModule" />
				<equals arg1="${project.name}" arg2="hpayBuild" />
			</or>
			<then>
				<echo message="ignore it ${project.name}" />
			</then>
			<else>
				<copy todir="${project.target}">
					<fileset dir="../${project.name}/${project.target}">
						<!--<include name="*.jar" />-->
						<include name="*.war" />
					</fileset>
				</copy>
			</else>
		</if>
		<echo message="end copy the project: ${project.name}" />
	</target>
	
	<target name="copy" depends="foreach">
		<echo message="copy to:${deployPath}" />
		<copy todir="${deployPath}" overwrite="true">
			<fileset dir="${project.target}">
				<!--<include name="*.jar" />-->
				<include name="*.war" />
			</fileset>
		</copy>
	</target>
	
</project>

